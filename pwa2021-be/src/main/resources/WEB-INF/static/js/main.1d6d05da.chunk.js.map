{"version":3,"sources":["sockjs/client.jsx","config/GlobalConstant.js","api/ApiCaller.js","holder/UserContextHolder.js","component/MessageBox.js","component/MessageListViewer.js","action/UserAction.js","page/chat/ChatRoom.js","component/user/OnlineUserItem.js","page/OnlineUsers.js","App.js","serviceWorker.js","index.js"],"names":["SockJsClient","props","_initStompClient","client","Stomp","over","SockJS","url","options","heartbeat","outgoing","incoming","Object","keys","includes","heartbeatIncoming","heartbeatOutgoing","debug","_cleanUp","setState","connected","retryCount","subscriptions","clear","subscriptionIdCounter","_log","msg","console","log","_subscribe","topic","has","subscriptionHeaders","assign","subscribeHeaders","id","sub","subscribe","onMessage","_processMessage","body","headers","destination","set","msgBody","JSON","parse","e","_unsubscribe","get","unsubscribe","delete","_connect","connect","topics","forEach","onConnect","error","onConnectFailure","stack","state","onDisconnect","autoReconnect","explicitDisconnect","_timeoutId","setTimeout","getRetryInterval","disconnect","clearTimeout","subid","sendMessage","optHeaders","Error","send","Map","this","nextProps","nextState","difference","oldTopic","newTopic","React","Component","defaultProps","count","GlobalConstant","FULL_WEB_SOCKET_URL","HTTP_PROTOCOL","DOMAIN_NAME","WEB_SOCKET_URL_SUFFIX","ApiCaller","data","callback","errorCallback","onResp","callUrl","key","call","method","jsonData","stringify","request","GLOBAL_CONST","mode","fetch","then","res","undefined","json","catch","ORIGIN_URL","REST_API_PREFIX","REST_API_ENDPOINT","GET_USER_CONTEXT","PREPARE_ROOM","GET_LAST_MESSAGES_FROM_ROOM","SEND_MESSAGE_TO_ROOM","UserContextHolder","user","userHolder","onlineUsers","onlineUsersHolder","MessageBox","message","messageAuthor","author","authorFullName","isMine","userId","avatar","userAvatar","startsSequence","startSequence","endsSequence","endSequence","friendlyTimestamp","Date","messageRowForTooltip","getMessageRowForTooltip","className","join","mine","Avatar","src","style","title","MessageListViewer","scrollArea","scrollBottom","messages","length","messageBoxes","map","value","ref","speed","minScrollSize","height","UserAction","roomId","onGetMessage","getCall","onRecive","resp","ChatRoom","roomTittle","isLoaded","clientRef","messageList","messageBox","getLastDataForRoom","bind","forceUpdate","onRes","container","direction","justify","alignItems","xs","label","inputRef","multiline","defaultValue","variant","fullWidth","margin","width","marginRight","color","onClick","unshift","jsSock","prepareJsSock","marginTop","component","disableSpacing","renderTextForm","renderChat","roomTitle","StyledBadge","withStyles","theme","badge","backgroundColor","boxShadow","palette","background","paper","position","top","left","borderRadius","animation","border","content","transform","opacity","Badge","OnlineUserItem","prepareAvatar","isOnline","primary","userName","secondary","Fragment","overlap","anchorOrigin","vertical","horizontal","alt","OnlineUsers","users","onlineUser","prepareUsers","usersClone","userIndex","push","foundUserIndex","findUserIndex","list","onlineUserItems","getOnlineUserItems","onSendButtomClicked","index","onSendButtonClicked","App","isReady","chatRoom","nextContext","prepareRoomForUser","userDataDtoSet","getUserContext","historicalMessagesDTO","changeRoom","lastRoomId","getSetUserHolder","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"8YAcMA,E,kDAmFJ,WAAaC,GAAQ,IAAD,8BAClB,cAAMA,IAiDRC,iBAAmB,WAEjB,EAAKC,OAASC,IAAMC,KAAK,IAAIC,IAAO,EAAKL,MAAMM,IAAK,KAAM,EAAKN,MAAMO,UAErE,EAAKL,OAAOM,UAAUC,SAAW,EAAKT,MAAMQ,UAC5C,EAAKN,OAAOM,UAAUE,SAAW,EAAKV,MAAMQ,UAExCG,OAAOC,KAAK,EAAKZ,OAAOa,SAAS,uBACnC,EAAKX,OAAOM,UAAUE,SAAW,EAAKV,MAAMc,mBAE1CH,OAAOC,KAAK,EAAKZ,OAAOa,SAAS,uBACnC,EAAKX,OAAOM,UAAUC,SAAW,EAAKT,MAAMe,mBAEzC,EAAKf,MAAMgB,QACd,EAAKd,OAAOc,MAAQ,eAhEJ,EAoEpBC,SAAW,WACT,EAAKC,SAAS,CAAEC,WAAW,IAC3B,EAAKC,WAAa,EAClB,EAAKC,cAAcC,QACnB,EAAKC,sBAAwB,GAxEX,EA2EpBC,KAAO,SAACC,GACF,EAAKzB,MAAMgB,OACbU,QAAQC,IAAIF,IA7EI,EAiFpBG,WAAa,SAACC,GACZ,IAAK,EAAKR,cAAcS,IAAID,GAAQ,CAClCH,QAAQC,IAAI,QACZ,IAAII,EAAsBpB,OAAOqB,OAAO,EAAKhC,MAAMiC,iBAAkB,CAACC,GAAK,OAAS,EAAKX,0BACzFG,QAAQC,IAAII,GACZ,IAAII,EAAM,EAAKjC,OAAOkC,UAAUP,GAAO,SAACJ,GACtC,EAAKzB,MAAMqC,UAAU,EAAKC,gBAAgBb,EAAIc,MAAOd,EAAIe,QAAQC,eAChEV,GACH,EAAKV,cAAcqB,IAAIb,EAAOM,KAzFd,EA6FpBG,gBAAkB,SAACK,GACjB,IACE,OAAOC,KAAKC,MAAMF,GAClB,MAAOG,GACP,OAAOH,IAjGS,EAqGpBI,aAAe,SAAClB,GACJ,EAAKR,cAAc2B,IAAInB,GAC7BoB,YAAYpB,GAChB,EAAKR,cAAc6B,OAAOrB,IAxGR,EA2GpBsB,SAAW,WACT,EAAKlD,mBACL,EAAKC,OAAOkD,QAAQ,EAAKpD,MAAMwC,SAAS,WACtC,EAAKtB,SAAS,CAAEC,WAAW,IAC3B,EAAKnB,MAAMqD,OAAOC,SAAQ,SAACzB,GACzB,EAAKD,WAAWC,MAElB,EAAK7B,MAAMuD,eACV,SAACC,GACEA,IACE7C,OAAOC,KAAK,EAAKZ,OAAOa,SAAS,oBACnC,EAAKb,MAAMyD,iBAAiBD,GAE5B,EAAKhC,KAAKgC,EAAME,QAGhB,EAAKC,MAAMxC,YACb,EAAKF,WAEL,EAAKjB,MAAM4D,gBAET,EAAK5D,MAAM6D,gBAAkB,EAAKF,MAAMG,qBAC1C,EAAKC,WAAaC,WAAW,EAAKb,SAAU,EAAKnD,MAAMiE,iBAAiB,EAAK7C,oBAjI/D,EA6IpBgC,QAAU,WACR,EAAKlC,SAAS,CAAE4C,oBAAoB,IAC/B,EAAKH,MAAMxC,WACd,EAAKgC,YAhJW,EAyJpBe,WAAa,WAGP,EAAKH,aACPI,aAAa,EAAKJ,YAClB,EAAKA,WAAa,MAEpB,EAAK7C,SAAS,CAAE4C,oBAAoB,IAChC,EAAKH,MAAMxC,YACb,EAAKE,cAAciC,SAAQ,SAACc,EAAOvC,GACjC,EAAKkB,aAAalB,MAEpB,EAAK3B,OAAOgE,YAAW,WACrB,EAAKjD,WACL,EAAKjB,MAAM4D,eACX,EAAKpC,KAAK,mDAxKI,EAqLpB6C,YAAc,SAACxC,EAAOJ,GAA0B,IAArB6C,EAAoB,uDAAP,GACtC,IAAI,EAAKX,MAAMxC,UAGb,MAAM,IAAIoD,MAAM,4CAFhB,EAAKrE,OAAOsE,KAAK3C,EAAOyC,EAAY7C,IApLtC,EAAKkC,MAAQ,CACXxC,WAAW,EAEX2C,oBAAoB,GAGtB,EAAKzC,cAAgB,IAAIoD,IACzB,EAAKrD,WAAa,EAClB,EAAKG,sBAAwB,EAXX,E,gEAelBmD,KAAKvB,a,6CAILuB,KAAKR,e,4CAGgBS,EAAWC,GAChC,OAAO,I,uDAKyBD,GAAY,IAAD,OACvCD,KAAKf,MAAMxC,YAEb0D,IAAWH,KAAK1E,MAAMqD,OAAQsB,EAAUtB,QACrCC,SAAQ,SAACwB,GACR,EAAKtD,KAAK,6BAA+BsD,GACzC,EAAK/B,aAAa+B,MAItBD,IAAWF,EAAUtB,OAAQqB,KAAK1E,MAAMqD,QACrCC,SAAQ,SAACyB,GACR,EAAKvD,KAAK,yBAA2BuD,GACrC,EAAKnD,WAAWmD,S,+BAMtB,OAAO,S,GAlIgBC,IAAMC,WAA3BlF,EACGmF,aAAe,CACpB3B,UAAW,aACXK,aAAc,aACdK,iBAAkB,SAACkB,GAAY,OAAO,IAAOA,GAC7C5E,QAAS,GACTiC,QAAS,GACTP,iBAAkB,GAClB4B,eAAe,EACf7C,OAAO,EACPR,UAAW,KAuQAT,Q,8IC/RTqF,E,kCAAAA,EAQKC,qBARLD,EACKE,cAAgB,YADrBF,EAEKG,YAAc,2BAFnBH,EAIKI,sBAAwB,OAQpBJ,QCVTK,E,qGAWanF,EAAKoF,EAAMC,EAAUC,EAAeC,GAC/C,IAAIC,EAAUxF,EACd,GAAY,OAAToF,EAAe,CACd,IAAM9E,EAAOD,OAAOC,KAAK8E,GAEzB,IAAK,IAAIK,KADTD,GAAoB,IACJlF,EACZkF,GAAWlF,EAAKmF,GAAO,IAAML,EAAK9E,EAAKmF,IAAQ,IAGvDrB,KAAKsB,KAAKF,EAAS,MAAO,KAAMH,EAAUC,EAAeC,K,2BAGjDvF,EAAK2F,EAAQP,EAAMC,EAAUC,EAAeC,GACpD,IAAIK,EAAqB,OAATR,EAAgB9C,KAAKuD,UAAUT,GAAO,KAElDU,EAAU,CACVH,OAAQA,EACRzD,QAAS,CACL,OAAU6D,EAAaf,cAAgBe,EAAad,YACpD,eAAgB,mBAChB,+BAAgC,8EAEpCe,KAAM,QAGM,OAAbJ,IACCE,EAAO,KAAWF,GAGtBK,MAAMjG,EAAK8F,GACNI,MAAK,SAAAC,GACF,YAAeC,IAAXb,EACOA,EAAOY,GAEPA,EAAIE,UAGlBH,MAAK,SAACd,GACCC,EAASD,MAEhBkB,OAAM,SAAClB,QACkBgB,IAAlBd,EACAA,EAAcF,GAEdhE,QAAQC,IAAI+D,U,KAvD1BD,EAEKoB,WAAaR,EAAaf,cAAgBe,EAAad,YAF5DE,EAGKqB,gBAAkB,UAHvBrB,EAIKsB,kBAAoBtB,EAAUoB,WAAapB,EAAUqB,gBAJ1DrB,EAMKuB,iBAAmB,gBANxBvB,EAOKwB,aAAexB,EAAUqB,gBAAkB,gBAPhDrB,EAQKyB,4BAA8BzB,EAAUsB,kBAAoB,iBARjEtB,EASK0B,qBAAuB1B,EAAUsB,kBAAoB,QAoDjDtB,QC7DT2B,E,uGAIaC,GACXD,EAAkBE,WAAaD,I,uCAI/B,OAAOD,EAAkBE,a,qCAGdC,GACXH,EAAkBI,kBAAoBD,I,uCAItC,OAAOH,EAAkBE,e,KAjB3BF,EACKE,WAAa,KADlBF,EAEKI,kBAAoB,KAmBhBJ,QC4CAK,E,uKAzDP,IAAMC,EAAUhD,KAAK1E,MAAM0H,QAAQA,QAC7BC,EAAgBjD,KAAK1E,MAAM0H,QAAQE,OAAOC,eAC1CC,EAASpD,KAAK1E,MAAM0H,QAAQE,OAAOG,SAAWX,EAAkBE,WAAWS,OAC3EC,EAAStD,KAAK1E,MAAM0H,QAAQE,OAAOK,WACnCC,EAAkBxD,KAAK1E,MAAMmI,cAAiBzD,KAAK1E,MAAMmI,cAAgB,QACzEC,EAAgB1D,KAAK1E,MAAMqI,YAAe3D,KAAK1E,MAAMqI,YAAc,MAEnEC,EAAoB,GAAK,IAAIC,KAE/BC,EAAuB9D,KAAK+D,wBAAwBd,EAAeK,EAAQN,EAASI,EAAQQ,GAChG,OACQ,uBAAKI,UAAW,CACZ,UADY,UAETZ,EAAS,OAAS,IAFT,UAGTI,EAAiB,QAAU,IAHlB,UAITE,EAAe,MAAQ,KAC5BO,KAAK,OAVO,EAmBTH,K,8CAKOb,EAAeK,EAAQN,EAASkB,EAAMN,GAC1D,OAAKM,EAaO,uBAAKF,UAAU,oBAEf,uBAAKA,UAAU,UACVhB,GAEL,gBAACmB,EAAA,EAAD,CAAQC,IAAKd,EAAQe,MAAO,CAAC,OAAU,kBAAvC,MAhBJ,uBAAKL,UAAU,oBAEP,gBAACG,EAAA,EAAD,CAAQC,IAAKd,EAAQe,MAAO,CAAC,OAAU,kBAAvC,KAGA,uBAAKL,UAAU,SAASM,MAAOV,GAC1BZ,Q,GA1CJ1C,a,kBCuCViE,E,kDAxCX,WAAYjJ,GAAQ,IAAD,8BACf,cAAMA,IACDkJ,WAAa,KAFH,E,2DAMQ,OAApBxE,KAAKwE,YACJxE,KAAKwE,WAAWC,iB,+BAId,IAAD,OACCC,EAAW1E,KAAK1E,MAAMoJ,SAC5B,GAAIA,EAASC,OAAS,EAAG,CACrB,IAAIC,EAAeF,EAASG,KAAI,SAACC,EAAOzD,GACpC,OACQ,gBAAC,EAAD,CAAY2B,QAAS8B,OAIjC,OACI,gBAAC,IAAD,CAAYC,IAAK,SAAC3G,GACd,EAAKoG,WAAapG,GAEV4G,MAAO,GACPC,cAAe,IACfZ,MAAO,CAACa,OAAQ,UAExB,2BACKN,IAKb,OAAQ,gC,GApCYtE,aCqCjB6E,E,gHArCcC,EAAQC,GAC7BtE,EAAUuE,QACNvE,EAAUyB,4BACV,CACI,OAAU4C,IAEd,SAACrD,GACGsD,EAAatD,MAEjB,SAACA,GACG/E,QAAQ8B,MAAMiD,Q,kCAIPqD,EAAQN,EAAOS,GAC9BxE,EAAUO,KAAKP,EAAU0B,qBACrB,OACA,CACI,OAAU2C,EACV,QAAWN,IAEf,SAACU,GACGD,S,qCAKUA,GAClBxE,EAAUuE,QAAQvE,EAAUuB,iBACxB,MACA,SAACkD,GACGD,EAASC,U,KC0HVC,E,kDA7IX,WAAYnK,GAAQ,IAAD,6BACf,cAAMA,GACN0B,QAAQC,IAAI3B,GACZ,EAAK2D,MAAQ,CACTmG,OAAQ9J,EAAM8J,OACdM,WAAYpK,EAAMgJ,MAClBqB,cAA6B3D,IAAnB1G,EAAMoJ,SAChBA,SAAUpJ,EAAMoJ,UAEpB,EAAKkB,UAAY,KACjB,EAAKC,YAAc,KACnB,EAAKC,WAAa,KAXH,E,uDAcRV,GAEP,OADApF,KAAK+F,mBAAmBX,GAChB,gC,iCAGDA,EAAQd,EAAOI,GACtB1E,KAAK+F,mBAAmBX,EAAQd,EAAOI,K,yCAGxBU,EAAQd,EAAOI,GACb,OAAbA,QAAkC1C,IAAb0C,EACrBS,EAAWY,mBAAmBX,EAAQpF,KAAKqF,aAAaW,KAAKhG,QAE7DA,KAAKxD,SAAS,CACVkI,SAAUA,EACViB,UAAU,EACVP,OAAQA,EACRM,WAAYpB,IAEhBtE,KAAKiG,iB,kCAIDb,EAAQN,EAAOoB,GACvBf,EAAWxF,YAAYyF,EAAQN,EAAOoB,K,qCAG3Bd,GAAS,IAAD,OAEnB,OADApI,QAAQC,IAAImI,GAER,kBAAC,IAAD,CAAMe,WAAS,EACTC,UAAU,MACVC,QAAQ,gBACRC,WAAW,UACb,kBAAC,IAAD,CAAMC,GAAI,GACN,kBAAC,IAAD,CACI/I,GAAG,eACHgJ,MAAM,UACNC,SAAU,SAACrI,GACP,EAAK0H,WAAa1H,GAEtBsI,WAAS,EACTC,aAAa,GACbC,QAAQ,WACRC,WAAS,EACTxC,MAAO,CAACyC,OAAQ,UAGxB,kBAAC,IAAD,CAAMP,GAAI,GACN,kBAAC,IAAD,CAAQK,QAAQ,YAAYvC,MAAO,CAAC0C,MAAO,OAAQ7B,OAAQ,OAAQ8B,YAAa,QACxEC,MAAO,UACPC,QAAS,SAAC9I,GACN,IAAM0G,EAAQ,EAAKgB,WAAWhB,MAC9B,EAAKnF,YAAYyF,EAAQN,GAAO,WAC5B,EAAKgB,WAAWhB,MAAQ,QALxC,Y,gCAgBN9B,GACN,IAAM6C,EAAc7F,KAAKf,MAAMyF,SAC/BmB,EAAYsB,QAAQnE,GACpBhD,KAAKxD,SAAS,CAACkI,SAAUmB,M,+BAGnB,IAAD,OACCT,EAASpF,KAAKf,MAAMmG,OACtBgC,EAASpH,KAAKqH,cAAcjC,GAEhC,OADApI,QAAQC,IAAImI,GACPpF,KAAKf,MAAM0G,SAIR,kBAAC,IAAD,CAAMtB,MAAO,CAACiD,UAAW,SACrB,kBAAC,IAAD,CAAYhD,MACR,kBAAC,IAAD,CAAYsC,QAAQ,QAAQK,MAAM,gBAAgBM,UAAU,KACvDvH,KAAKf,MAAMyG,cAGpB,kBAAC,IAAD,KACI,kBAAC,EAAD,CAAmBhB,SACf1E,KAAKf,MAAMyF,SAEIK,IAAK,SAAC3G,GAAD,OAAO,EAAKyH,YAAczH,MAEtD,kBAAC,IAAD,CAAaoJ,gBAAc,GACtBJ,EACApH,KAAKyH,eAAerC,KAjB1BpF,KAAK0H,WAAWtC,K,oCAyBjBA,GAAS,IAAD,OAClB,OAAQ,kBAAC,EAAD,CAAcxJ,IAAK8E,EAAeC,oBAAqBhC,OAAQ,CAAC,gBAAkByG,GACpEzH,UAAWqC,KAAKrC,UAAUqI,KAAKhG,MAC/Bb,eAAe,EACfN,UAAW,SAACT,GACRpB,QAAQC,IAAImB,IAGhBc,aAAclC,QAAQC,IAAI,iBAC1B8H,IAAK,SAACvJ,GACF,EAAKoK,UAAYpK,GAErBc,OAAO,M,mCAGpByF,GACT,IAAM2C,EAAW3C,EAAI2C,SACrB1E,KAAKxD,SAAS,CACVkI,SAAUA,EACViB,UAAU,EACVD,WAAY3D,EAAI4F,UAChBvC,OAAQrD,EAAIqD,a,GA1ID9E,IAAMC,W,yMCFvBqH,GAAcC,cAAW,SAACC,GAAD,MAAY,CACvCC,MAAO,CACHC,gBAAiB,UACjBf,MAAO,UACPgB,UAAU,aAAD,OAAeH,EAAMI,QAAQC,WAAWC,OACjD,WAAY,CACRC,SAAU,WACVC,IAAK,EACLC,KAAM,EACNxB,MAAO,OACP7B,OAAQ,OACRsD,aAAc,MACdC,UAAW,oCACXC,OAAQ,yBACRC,QAAS,OAGjB,oBAAqB,CACjB,KAAM,CACFC,UAAW,YACXC,QAAS,GAEb,OAAQ,CACJD,UAAW,aACXC,QAAS,OAxBDhB,CA2BhBiB,MAwDWC,G,uKApDD,IAAD,OACDC,EAAgBhJ,KAAKgJ,cAAchJ,KAAK1E,MAAM2N,UAElD,OACI,kBAAC,KAAD,CAAU3C,WAAW,cACjB,kBAAC,KAAD,KACK0C,GAEL,kBAAC,KAAD,CACIE,QAASlJ,KAAK1E,MAAMqH,KAAKwG,SACzBC,UACI,kBAAC,IAAMC,SAAP,KACI,kBAAC,IAAD,CACI9B,UAAU,OACVX,QAAQ,QACRK,MAAM,eAEN,kBAAC,IAAD,CAAQL,QAAQ,YAAYK,MAAM,UAAUC,QACxC,SAAC9I,GACA,EAAK9C,MAAM4L,QAAQ,EAAK5L,MAAMqH,KAAKU,UAFxC,uB,oCAad4F,GACV,OAAGA,EAEK,kBAACrB,GAAD,CACI0B,QAAQ,SACRC,aAAc,CACVC,SAAU,SACVC,WAAY,SAEhB7C,QAAQ,OAER,kBAAC,KAAD,CAAQ8C,IAAK1J,KAAK1E,MAAMqH,KAAKwG,SAAU/E,IAAKpE,KAAK1E,MAAMqH,KAAKW,UAKhE,kBAAC,KAAD,CAAQoG,IAAK1J,KAAK1E,MAAMqH,KAAKwG,SAAU/E,IAAKpE,KAAK1E,MAAMqH,KAAKW,a,GAhD/C/C,aCgFdoJ,G,kDA7GX,WAAYrO,GAAQ,IAAD,6BACf,cAAMA,GACN0B,QAAQC,IAAI3B,GACZ,EAAK2D,MAAQ,CAAC2K,MAAOtO,EAAMsO,OAHZ,E,sDAMT5I,GACN0B,EAAkBI,kBAAoB9B,EACtC,IAAI6I,EAAa7J,KAAK8J,aAAa9I,GACnChB,KAAKxD,SAAS,CAACoN,MAAOC,M,mCAGbA,GACT,IAAIE,EAAa/J,KAAKf,MAAM2K,MACxBA,EAAQ,GACZ,IAAI,IAAII,KAAaD,EACjBH,EAAMK,KACF,CACI5G,OAAQ0G,EAAWC,GAAW3G,OAC9B4F,UAAU,EACVE,SAAUY,EAAWC,GAAWb,SAChC7F,OAAQyG,EAAWC,GAAW1G,SAI1C,GAAkB,OAAfuG,QAAsC7H,IAAf6H,EAA0B,CAChD,IAAI,IAAIG,KAAaH,EAAY,CAC7B,IAAIlH,EAAOkH,EAAWG,GAClBE,EAAiBlK,KAAKmK,cAAcxH,EAAKU,OAAQuG,GAErD,IAAsB,GAAnBM,EACCvH,EAAKsG,UAAW,EAChBW,EAAMK,KAAK,CACP5G,OAAQV,EAAKU,OACb4F,UAAU,EACVE,SAAUxG,EAAKwG,SACf7F,OAAQX,EAAKW,cAICsG,EAAMM,GACZjB,UAAW,EAG/B,OAAOW,EAEX,OAAOA,I,oCAKGvG,EAAQ+G,GAClB,GAAY,OAATA,QAA0BpI,IAAToI,EAChB,OAAQ,EACZ,IAAI,IAAIzH,KAAQyH,EACZ,GAAGA,EAAKzH,GAAMU,SAAWA,EACrB,OAAOV,EAGf,OAAQ,I,+BAGF,IAAD,OACD0H,EAAkBrK,KAAKsK,qBAC3B,OACI,6BACI,kBAAC,KAAD,CAAc1O,IAAK8E,EAAeC,oBAAqBhC,OAAQ,CAAC,uBAClDhB,UAAWqC,KAAKrC,UAAUqI,KAAKhG,MAC/B+E,IAAK,SAACvJ,GACF,EAAKoK,UAAYpK,KAGnC,kBAAC,IAAD,CAAYoL,QAAQ,KAAKW,UAAU,KAAKlD,MAAO,CAAC,UAAY,WAA5D,SAGA,kBAAC,KAAD,MACA,kBAAC,KAAD,KACKgG,GAEL,kBAAC,KAAD,S,0CAMQhH,GAChBrD,KAAK1E,MAAMiP,oBAAoBlH,K,2CAGb,IAAD,OACjB,OAAwB,OAArBrD,KAAKf,MAAM2K,YAAuC5H,IAArBhC,KAAKf,MAAM2K,OACI,OAAxClH,EAAkBI,mBACjB9C,KAAKxD,SAAS,CAACoN,MAAOlH,EAAkBI,oBAEpC,+BAEA9C,KAAKf,MAAM2K,MAEJ/E,KAAI,SAACC,EAAO0F,GAC3B,OAAG1F,EAAMzB,SAAWX,EAAkBE,WAAWS,OACrC,kBAAC,GAAD,CAAgBV,KAAMmC,EAAOoC,QAAS,EAAKuD,oBAAoBzE,KAAK,GAAOiD,SAAUnE,EAAMmE,WAE5F,qC,GAxGG1I,aCkFXmK,G,kDA5EX,WAAYpP,GAAQ,IAAD,8BACf,cAAMA,IACD2D,MAAQ,CACT0L,SAAS,EACTvF,OAAQ,KACRuC,eAAW3F,EACX0C,cAAU1C,GAEd,EAAK4I,SAAW,KARD,E,kEAWG3K,EAAWC,EAAW2K,GACxC,OAAO,I,+BAGD,IAAD,OACL,OAAK7K,KAAKf,MAAM0L,QAKR,6BACI,kBAAC,IAAD,CAAQtC,SAAS,SAASpB,MAAO,aAC7B,kBAAC,IAAD,KACI,kBAAC,IAAD,CAAYL,QAAQ,MAApB,mBAKR,kBAAC,IAAD,CACIN,WAAW,SACXH,WAAS,EACTC,UAAU,MACVC,QAAQ,gBACRhC,MAAO,CAAC,QAAW,SAEnB,kBAAC,IAAD,CAAMiC,WAAW,SAASC,GAAI,EAAGlC,MAAO,CAAC,OAAU,SAC/C,kBAAC,IAAD,KACI,kBAAC,GAAD,CAAakG,oBAAqBvK,KAAK8K,mBAAmB9E,KAAKhG,MAAO4J,MAAOlH,EAAkBE,WAAWmI,mBAIlH,kBAAC,IAAD,CAAMzE,WAAW,SAASC,GAAI,GAC1B,kBAAC,EAAD,CAAUnB,OAAQpF,KAAKf,MAAMmG,OAAQd,MAAOtE,KAAKf,MAAM0I,UAAW5C,IAAK,SAAC3G,GAAO,EAAKwM,SAAWxM,GAAIsG,SAAU1E,KAAKf,MAAMyF,eA1BxI1E,KAAKgL,iBACG,iC,yCAkCG3H,GAAS,IAAD,OACvBtC,EAAUO,KAAKP,EAAUwB,aAAc,OAAQ,CAAC,OAAUc,IACtD,SAACtB,GACG,EAAKvF,SACD,CACI4I,OAAQrD,EAAIqD,OACZuC,UAAW5F,EAAI4F,UACfjD,SAAU3C,EAAIkJ,sBAAsBvG,WACrC,WACH,EAAKkG,SAASM,WAAW,EAAKjM,MAAMmG,OAAQ,EAAKnG,MAAM0I,UAAW,EAAK1I,MAAMyF,kB,uCAK5E3C,GACbW,EAAkBE,WAAab,EAC/B/B,KAAKxD,SAAS,CAACmO,SAAS,EAAMvF,OAAQrD,EAAIoJ,WAAYxD,UAAW5F,EAAI4F,c,uCAIrExC,EAAW6F,eAAehL,KAAKoL,iBAAiBpF,KAAKhG,W,GAzE3CO,aCHE8K,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,2DCZNC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,GAAD,OAEFC,SAASC,eAAe,SDyHpB,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrBnK,MAAK,SAAAoK,GACJA,EAAaC,gBAEdjK,OAAM,SAAApD,GACL9B,QAAQ8B,MAAMA,EAAMkE,c","file":"static/js/main.1d6d05da.chunk.js","sourcesContent":["import React from 'react'\r\nimport SockJS from 'sockjs-client'\r\nimport Stomp from 'stompjs'\r\nimport PropTypes from 'prop-types'\r\nimport difference from 'lodash/difference'\r\n\r\n/**\r\n * React component for SockJS-client with STOMP messaging protocol.\r\n *\r\n * @version 5.0.0\r\n * @author [lahsivjar] (https://github.com/lahsivjar)\r\n * @see {@link https://stomp.github.io/|STOMP}\r\n * @see {@link https://github.com/sockjs/sockjs-client|StompJS}\r\n */\r\nclass SockJsClient extends React.Component {\r\n  static defaultProps = {\r\n    onConnect: () => {},\r\n    onDisconnect: () => {},\r\n    getRetryInterval: (count) => { return 1000 * count },\r\n    options: {},\r\n    headers: {},\r\n    subscribeHeaders: {},\r\n    autoReconnect: true,\r\n    debug: false,\r\n    heartbeat: 10000\r\n  }\r\n\r\n  static propTypes = {\r\n    /**\r\n     * HTTP URL of the endpoint to connect.\r\n     */\r\n    url: PropTypes.string.isRequired,\r\n    /**\r\n     * Additional options to pass to the underlying SockJS constructor.\r\n     *\r\n     * @see [SockJS-options](https://github.com/sockjs/sockjs-client#sockjs-client-api)\r\n     */\r\n    options: PropTypes.object,\r\n    /**\r\n     * Array of topics to subscribe to.\r\n     */\r\n    topics: PropTypes.array.isRequired,\r\n    /**\r\n     * Callback after connection is established.\r\n     */\r\n    onConnect: PropTypes.func,\r\n    /**\r\n     * Callback after connection is lost.\r\n     */\r\n    onDisconnect: PropTypes.func,\r\n    /**\r\n     * Gets called to find the time interval for next retry. Defaults to a function returing retryCount seconds.\r\n     *\r\n     * @param {number} retryCount number of retries for the current disconnect\r\n     */\r\n    getRetryInterval: PropTypes.func,\r\n    /**\r\n     * Callback when a message is recieved.\r\n     *\r\n     * @param {(string|Object)} msg message received from server, if JSON format then object\r\n     * @param {string} topic the topic on which the message was received\r\n     */\r\n    onMessage: PropTypes.func.isRequired,\r\n    /**\r\n     * Headers that will be passed to the server or broker with STOMP's connection frame.\r\n     */\r\n    headers: PropTypes.object,\r\n    /**\r\n     * Headers that will be passed when subscribing to a destination.\r\n     */\r\n    subscribeHeaders: PropTypes.object,\r\n    /**\r\n     * Should the client try to automatically connect in an event of disconnection.\r\n     */\r\n    autoReconnect: PropTypes.bool,\r\n    /**\r\n     * Enable debugging mode.\r\n     */\r\n    debug: PropTypes.bool,\r\n    /**\r\n     * Number of milliseconds to send and expect heartbeat messages.\r\n     */\r\n    heartbeat: PropTypes.number,\r\n    /**\r\n     * Number of milliseconds to expect heartbeat messages\r\n     */\r\n    heartbeatIncoming: PropTypes.number,\r\n    /**\r\n     * Number of milliseconds to send heartbeat messages\r\n     */\r\n    heartbeatOutgoing: PropTypes.number,\r\n    /**\r\n     * Callback if connection could not be established\r\n     */\r\n    onConnectFailure: PropTypes.func\r\n  }\r\n\r\n  constructor (props) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      connected: false,\r\n      // False if disconnect method is called without a subsequent connect\r\n      explicitDisconnect: false\r\n    }\r\n\r\n    this.subscriptions = new Map()\r\n    this.retryCount = 0\r\n    this.subscriptionIdCounter = 0\r\n  }\r\n\r\n  componentDidMount () {\r\n    this._connect()\r\n  }\r\n\r\n  componentWillUnmount () {\r\n    this.disconnect()\r\n  }\r\n\r\n  shouldComponentUpdate (nextProps, nextState) {\r\n    return false\r\n  }\r\n\r\n  /* eslint camelcase: [\"error\", {allow: [\"UNSAFE_componentWillReceiveProps\"]}] */\r\n\r\n  UNSAFE_componentWillReceiveProps (nextProps) {\r\n    if (this.state.connected) {\r\n      // Unsubscribe from old topics\r\n      difference(this.props.topics, nextProps.topics)\r\n        .forEach((oldTopic) => {\r\n          this._log('Unsubscribing from topic: ' + oldTopic)\r\n          this._unsubscribe(oldTopic)\r\n        })\r\n\r\n      // Subscribe to new topics\r\n      difference(nextProps.topics, this.props.topics)\r\n        .forEach((newTopic) => {\r\n          this._log('Subscribing to topic: ' + newTopic)\r\n          this._subscribe(newTopic)\r\n        })\r\n    }\r\n  }\r\n\r\n  render () {\r\n    return null\r\n  }\r\n\r\n  _initStompClient = () => {\r\n    // Websocket held by stompjs can be opened only once\r\n    this.client = Stomp.over(new SockJS(this.props.url, null, this.props.options))\r\n\r\n    this.client.heartbeat.outgoing = this.props.heartbeat\r\n    this.client.heartbeat.incoming = this.props.heartbeat\r\n\r\n    if (Object.keys(this.props).includes('heartbeatIncoming')) {\r\n      this.client.heartbeat.incoming = this.props.heartbeatIncoming\r\n    }\r\n    if (Object.keys(this.props).includes('heartbeatOutgoing')) {\r\n      this.client.heartbeat.outgoing = this.props.heartbeatOutgoing\r\n    }\r\n    if (!this.props.debug) {\r\n      this.client.debug = () => {}\r\n    }\r\n  }\r\n\r\n  _cleanUp = () => {\r\n    this.setState({ connected: false })\r\n    this.retryCount = 0\r\n    this.subscriptions.clear()\r\n    this.subscriptionIdCounter = 0\r\n  }\r\n\r\n  _log = (msg) => {\r\n    if (this.props.debug) {\r\n      console.log(msg)\r\n    }\r\n  }\r\n\r\n  _subscribe = (topic) => {\r\n    if (!this.subscriptions.has(topic)) {\r\n      console.log(\"test\");\r\n      let subscriptionHeaders = Object.assign(this.props.subscribeHeaders, {id : \"sub-\" + this.subscriptionIdCounter++});\r\n      console.log(subscriptionHeaders);\r\n      let sub = this.client.subscribe(topic, (msg) => {\r\n        this.props.onMessage(this._processMessage(msg.body), msg.headers.destination)\r\n      }, subscriptionHeaders)\r\n      this.subscriptions.set(topic, sub)\r\n    }\r\n  }\r\n\r\n  _processMessage = (msgBody) => {\r\n    try {\r\n      return JSON.parse(msgBody)\r\n    } catch (e) {\r\n      return msgBody\r\n    }\r\n  }\r\n\r\n  _unsubscribe = (topic) => {\r\n    let sub = this.subscriptions.get(topic)\r\n    sub.unsubscribe(topic)\r\n    this.subscriptions.delete(topic)\r\n  }\r\n\r\n  _connect = () => {\r\n    this._initStompClient()\r\n    this.client.connect(this.props.headers, () => {\r\n      this.setState({ connected: true })\r\n      this.props.topics.forEach((topic) => {\r\n        this._subscribe(topic)\r\n      })\r\n      this.props.onConnect()\r\n    }, (error) => {\r\n      if (error) {\r\n        if (Object.keys(this.props).includes('onConnectFailure')) {\r\n          this.props.onConnectFailure(error)\r\n        } else {\r\n          this._log(error.stack)\r\n        }\r\n      }\r\n      if (this.state.connected) {\r\n        this._cleanUp()\r\n        // onDisconnect should be called only once per connect\r\n        this.props.onDisconnect()\r\n      }\r\n      if (this.props.autoReconnect && !this.state.explicitDisconnect) {\r\n        this._timeoutId = setTimeout(this._connect, this.props.getRetryInterval(this.retryCount++))\r\n      }\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Connect to the server if not connected. Under normal circumstances component\r\n   * will automatically try to connect to server. This method is mostly useful\r\n   * after component is explicitly disconnected via {@link SockJsClient#disconnect}.\r\n   *\r\n   * @public\r\n   */\r\n  connect = () => {\r\n    this.setState({ explicitDisconnect: false })\r\n    if (!this.state.connected) {\r\n      this._connect()\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Disconnect STOMP client and disable all reconnect.\r\n   *\r\n   * @public\r\n   */\r\n  disconnect = () => {\r\n    // On calling disconnect explicitly no effort will be made to reconnect\r\n    // Clear timeoutId in case the component is trying to reconnect\r\n    if (this._timeoutId) {\r\n      clearTimeout(this._timeoutId)\r\n      this._timeoutId = null\r\n    }\r\n    this.setState({ explicitDisconnect: true })\r\n    if (this.state.connected) {\r\n      this.subscriptions.forEach((subid, topic) => {\r\n        this._unsubscribe(topic)\r\n      })\r\n      this.client.disconnect(() => {\r\n        this._cleanUp()\r\n        this.props.onDisconnect()\r\n        this._log('Stomp client is successfully disconnected!')\r\n      })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send message to the specified topic.\r\n   *\r\n   * @param {string} topic target topic to send message\r\n   * @param {string} msg message to send\r\n   * @param {Object} [opt_headers={}] additional headers for underlying STOMP client\r\n   * @public\r\n   */\r\n  sendMessage = (topic, msg, optHeaders = {}) => {\r\n    if (this.state.connected) {\r\n      this.client.send(topic, optHeaders, msg)\r\n    } else {\r\n      throw new Error('Send error: SockJsClient is disconnected')\r\n    }\r\n  }\r\n}\r\n\r\nexport default SockJsClient\r\n","class GlobalConstant {\r\n    static HTTP_PROTOCOL = \"http://\";\r\n    static DOMAIN_NAME = \"pwa-2021.herokuapp.com\";\r\n\r\n    static WEB_SOCKET_URL_SUFFIX = \"/ws\";\r\n\r\n    //static HTTP_PROTOCOL = \"http://\";\r\n    //static DOMAIN_NAME = \"localhost:8080\";\r\n    static FULL_WEB_SOCKET_URL = GlobalConstant.HTTP_PROTOCOL + GlobalConstant.DOMAIN_NAME + GlobalConstant.WEB_SOCKET_URL_SUFFIX;\r\n\r\n}\r\n\r\nexport default GlobalConstant;\r\n","import GLOBAL_CONST from \"../config/GlobalConstant\";\r\n\r\nclass ApiCaller {\r\n\r\n    static ORIGIN_URL = GLOBAL_CONST.HTTP_PROTOCOL + GLOBAL_CONST.DOMAIN_NAME;\r\n    static REST_API_PREFIX = \"/api/v1\";\r\n    static REST_API_ENDPOINT = ApiCaller.ORIGIN_URL + ApiCaller.REST_API_PREFIX;\r\n\r\n    static GET_USER_CONTEXT = \"/user/context\";\r\n    static PREPARE_ROOM = ApiCaller.REST_API_PREFIX + \"/room/prepare\";\r\n    static GET_LAST_MESSAGES_FROM_ROOM = ApiCaller.REST_API_ENDPOINT + \"/room/messages\";\r\n    static SEND_MESSAGE_TO_ROOM = ApiCaller.REST_API_ENDPOINT + \"/send\";\r\n\r\n    static getCall(url, data, callback, errorCallback, onResp) {\r\n        let callUrl = url;\r\n        if(data !== null) {\r\n            const keys = Object.keys(data);\r\n            callUrl = callUrl + \"?\";\r\n            for (let key in keys) {\r\n                callUrl += keys[key] + \"=\" + data[keys[key]] + \"&\";\r\n            }\r\n        }\r\n        this.call(callUrl, \"GET\", null, callback, errorCallback, onResp);\r\n    }\r\n\r\n    static call(url, method, data, callback, errorCallback, onResp) {\r\n        let jsonData = (data !== null)? JSON.stringify(data): null;\r\n\r\n        let request = {\r\n            method: method,\r\n            headers: {\r\n                'Origin': GLOBAL_CONST.HTTP_PROTOCOL + GLOBAL_CONST.DOMAIN_NAME,\r\n                'Content-Type': 'application/json',\r\n                'Access-Control-Allow-Headers': 'Origin, X-Requested-With, Content-Type, Accept, Set-cookies, Authorization'\r\n            },\r\n            mode: \"cors\"\r\n        };\r\n\r\n        if(jsonData !== null) {\r\n            request[\"body\"] = jsonData;\r\n        }\r\n\r\n        fetch(url, request)\r\n            .then(res => {\r\n                if (onResp !== undefined) {\r\n                    return onResp(res);\r\n                } else {\r\n                    return res.json();\r\n                }\r\n            })\r\n            .then((data) => {\r\n                    callback(data);\r\n            })\r\n            .catch((data) => {\r\n                if (errorCallback !== undefined) {\r\n                    errorCallback(data);\r\n                } else {\r\n                    console.log(data);\r\n                }\r\n            })\r\n    }\r\n}\r\n\r\nexport default ApiCaller;\r\n","import ApiCaller from \"../api/ApiCaller\";\r\n\r\nclass UserContextHolder {\r\n    static userHolder = null;\r\n    static onlineUsersHolder = null;\r\n\r\n    setUserContext(user) {\r\n        UserContextHolder.userHolder = user;\r\n    }\r\n\r\n    getUserContext() {\r\n        return UserContextHolder.userHolder;\r\n    }\r\n\r\n    setOnlineUsers(onlineUsers) {\r\n        UserContextHolder.onlineUsersHolder = onlineUsers;\r\n    }\r\n\r\n    getOnlineUsers() {\r\n        return UserContextHolder.userHolder;\r\n    }\r\n}\r\n\r\nexport default UserContextHolder;\r\n","import * as React from \"react\";\r\n//import moment from 'moment';\r\nimport './Message.css';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport UserContextHolder from \"../holder/UserContextHolder\";\r\n\r\n\r\nclass MessageBox extends React.Component {\r\n\r\n    render() {\r\n        const message = this.props.message.message;\r\n        const messageAuthor = this.props.message.author.authorFullName;\r\n        const isMine = this.props.message.author.userId === UserContextHolder.userHolder.userId;\r\n        const avatar = this.props.message.author.userAvatar;\r\n        const startsSequence = (this.props.startSequence) ? this.props.startSequence : \"start\";\r\n        const endsSequence = (this.props.endSequence) ? this.props.endSequence : \"end\";\r\n        const showTimestamp = false;\r\n        const friendlyTimestamp = \"\" + new Date();\r\n\r\n        let messageRowForTooltip = this.getMessageRowForTooltip(messageAuthor, avatar, message, isMine, friendlyTimestamp);\r\n        return (\r\n                <div className={[\r\n                    'message',\r\n                    `${isMine ? 'mine' : ''}`,\r\n                    `${startsSequence ? 'start' : ''}`,\r\n                    `${endsSequence ? 'end' : ''}`\r\n                ].join(' ')}>\r\n                    {\r\n                        showTimestamp &&\r\n                        <div className=\"timestamp\">\r\n                            {friendlyTimestamp}\r\n                        </div>\r\n\r\n\r\n                    }\r\n                    {messageRowForTooltip}\r\n                </div>\r\n        );\r\n    }\r\n\r\n    getMessageRowForTooltip(messageAuthor, avatar, message, mine, friendlyTimestamp) {\r\n        if (!mine) {\r\n            return (\r\n                <div className=\"bubble-container\">\r\n\r\n                        <Avatar src={avatar} style={{\"margin\": \"auto 0 auto 0\"}}>\r\n                            B\r\n                        </Avatar>\r\n                        <div className=\"bubble\" title={friendlyTimestamp}>\r\n                            {message}\r\n                        </div>\r\n                </div>\r\n            );\r\n        } else {\r\n            return (<div className=\"bubble-container\">\r\n\r\n                    <div className=\"bubble\">\r\n                        {message}\r\n                    </div>\r\n                    <Avatar src={avatar} style={{\"margin\": \"auto 0 auto 0\"}}>\r\n                        B\r\n                    </Avatar>\r\n            </div>);\r\n        }\r\n    }\r\n}\r\n\r\nexport default MessageBox;\r\n","import * as React from \"react\";\r\nimport MessageBox from \"./MessageBox\";\r\nimport ScrollArea from 'react-scrollbar';\r\n\r\nclass MessageListViewer extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.scrollArea = null;\r\n    }\r\n\r\n    onNewMessage() {\r\n        if(this.scrollArea !== null) {\r\n            this.scrollArea.scrollBottom();\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const messages = this.props.messages;\r\n        if (messages.length > 0) {\r\n            let messageBoxes = messages.map((value, key) => {\r\n                return (\r\n                        <MessageBox message={value}/>\r\n                )\r\n            });\r\n\r\n            return (\r\n                <ScrollArea ref={(e) => {\r\n                    this.scrollArea = e;\r\n                }}\r\n                            speed={0.8}\r\n                            minScrollSize={400}\r\n                            style={{height: \"500px\"}}\r\n                >\r\n                    <div>\r\n                        {messageBoxes}\r\n                    </div>\r\n                </ScrollArea>\r\n            );\r\n        } else {\r\n            return (<div/>);\r\n        }\r\n\r\n    }\r\n}\r\n\r\nexport default MessageListViewer;\r\n","import ApiCaller from \"../api/ApiCaller\";\r\n\r\nclass UserAction {\r\n\r\n   static getLastDataForRoom(roomId, onGetMessage) {\r\n        ApiCaller.getCall(\r\n            ApiCaller.GET_LAST_MESSAGES_FROM_ROOM,\r\n            {\r\n                \"roomID\": roomId\r\n            },\r\n            (res) => {\r\n                onGetMessage(res);\r\n            },\r\n            (res) => {\r\n                console.error(res);\r\n            });\r\n    }\r\n\r\n    static sendMessage(roomId, value, onRecive) {\r\n        ApiCaller.call(ApiCaller.SEND_MESSAGE_TO_ROOM,\r\n            \"POST\",\r\n            {\r\n                \"roomId\": roomId,\r\n                \"message\": value\r\n            },\r\n            (resp) => {\r\n                onRecive();\r\n            }\r\n        );\r\n    }\r\n\r\n    static getUserContext(onRecive) {\r\n        ApiCaller.getCall(ApiCaller.GET_USER_CONTEXT,\r\n            null,\r\n            (resp) => {\r\n                onRecive(resp);\r\n            }\r\n        );\r\n    }\r\n}\r\n\r\nexport default UserAction;\r\n","import React from \"react\";\r\nimport SockJsClient from \"../../sockjs/client\"\r\nimport Button from \"@material-ui/core/Button/Button\";\r\nimport TextField from \"@material-ui/core/TextField/TextField\";\r\nimport Grid from \"@material-ui/core/Grid/Grid\";\r\nimport Card from \"@material-ui/core/Card/Card\";\r\nimport CardHeader from \"@material-ui/core/CardHeader/CardHeader\";\r\nimport CardContent from \"@material-ui/core/CardContent/CardContent\";\r\nimport Typography from \"@material-ui/core/Typography/Typography\";\r\nimport CardActions from \"@material-ui/core/CardActions/CardActions\";\r\nimport MessageListViewer from \"../../component/MessageListViewer\";\r\nimport GlobalConstant from \"../../config/GlobalConstant\";\r\nimport UserAction from \"../../action/UserAction\"\r\n\r\nclass ChatRoom extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        console.log(props);\r\n        this.state = {\r\n            roomId: props.roomId,\r\n            roomTittle: props.title,\r\n            isLoaded: props.messages !== undefined,\r\n            messages: props.messages\r\n        };\r\n        this.clientRef = null;\r\n        this.messageList = null;\r\n        this.messageBox = null;\r\n    }\r\n\r\n    renderChat(roomId) {\r\n        this.getLastDataForRoom(roomId);\r\n        return (<div/>);\r\n    }\r\n\r\n    changeRoom(roomId, title, messages) {\r\n        this.getLastDataForRoom(roomId, title, messages);\r\n    }\r\n\r\n    getLastDataForRoom(roomId, title, messages) {\r\n        if (messages === null || messages === undefined) {\r\n            UserAction.getLastDataForRoom(roomId, this.onGetMessage.bind(this));\r\n        } else {\r\n            this.setState({\r\n                messages: messages,\r\n                isLoaded: true,\r\n                roomId: roomId,\r\n                roomTittle: title\r\n            });\r\n            this.forceUpdate();\r\n        }\r\n    }\r\n\r\n    sendMessage(roomId, value, onRes) {\r\n        UserAction.sendMessage(roomId, value, onRes);\r\n    }\r\n\r\n    renderTextForm(roomId) {\r\n        console.log(roomId);\r\n        return (\r\n            <Grid container\r\n                  direction=\"row\"\r\n                  justify=\"space-between\"\r\n                  alignItems=\"center\">\r\n                <Grid xs={8}>\r\n                    <TextField\r\n                        id=\"message_text\"\r\n                        label=\"Message\"\r\n                        inputRef={(e) => {\r\n                            this.messageBox = e\r\n                        }}\r\n                        multiline\r\n                        defaultValue=\"\"\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        style={{margin: \"5px\"}}\r\n                    />\r\n                </Grid>\r\n                <Grid xs={3}>\r\n                    <Button variant=\"contained\" style={{width: \"100%\", height: \"100%\", marginRight: \"10px\"}}\r\n                            color={\"primary\"}\r\n                            onClick={(e) => {\r\n                                const value = this.messageBox.value;\r\n                                this.sendMessage(roomId, value, () => {\r\n                                    this.messageBox.value = \"\";\r\n                                });\r\n                            }}\r\n                    >\r\n                        Send\r\n                    </Button>\r\n                </Grid>\r\n            </Grid>\r\n        );\r\n    }\r\n\r\n    onMessage(message) {\r\n        const messageList = this.state.messages;\r\n        messageList.unshift(message);\r\n        this.setState({messages: messageList});\r\n    }\r\n\r\n    render() {\r\n        const roomId = this.state.roomId;\r\n        let jsSock = this.prepareJsSock(roomId);\r\n        console.log(roomId);\r\n        if (!this.state.isLoaded) {\r\n            return this.renderChat(roomId)\r\n        } else {\r\n            return (\r\n                <Card style={{marginTop: \"20px\"}}>\r\n                    <CardHeader title={\r\n                        <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">\r\n                            {this.state.roomTittle}\r\n                        </Typography>\r\n                    }/>\r\n                    <CardContent>\r\n                        <MessageListViewer messages={\r\n                            this.state.messages\r\n                        }\r\n                                           ref={(e) => this.messageList = e}/>\r\n                    </CardContent>\r\n                    <CardActions disableSpacing>\r\n                        {jsSock}\r\n                        {this.renderTextForm(roomId)}\r\n                    </CardActions>\r\n\r\n                </Card>\r\n            );\r\n        }\r\n    }\r\n\r\n    prepareJsSock(roomId) {\r\n        return (<SockJsClient url={GlobalConstant.FULL_WEB_SOCKET_URL} topics={['/topics/room/' + roomId]}\r\n                              onMessage={this.onMessage.bind(this)}\r\n                              autoReconnect={true}\r\n                              onConnect={(e) => {\r\n                                  console.log(e);\r\n                                }\r\n                              }\r\n                              onDisconnect={console.log(\"Disconnected!\")}\r\n                              ref={(client) => {\r\n                                  this.clientRef = client\r\n                              }}\r\n                              debug={true}/>);\r\n    }\r\n\r\n    onGetMessage(res) {\r\n        const messages = res.messages;\r\n        this.setState({\r\n            messages: messages,\r\n            isLoaded: true,\r\n            roomTittle: res.roomTitle,\r\n            roomId: res.roomId\r\n        });\r\n    }\r\n}\r\n\r\nexport default ChatRoom;\r\n","import {Component} from \"react\";\r\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar/ListItemAvatar\";\r\nimport Avatar from \"@material-ui/core/Avatar/Avatar\";\r\nimport ListItemText from \"@material-ui/core/ListItemText/ListItemText\";\r\nimport React from \"react\";\r\nimport Badge from '@material-ui/core/Badge';\r\nimport Typography from \"@material-ui/core/Typography/Typography\";\r\nimport ListItem from \"@material-ui/core/ListItem/ListItem\";\r\nimport Button from \"@material-ui/core/Button/Button\";\r\n\r\nimport {withStyles } from '@material-ui/core/styles';\r\n\r\nconst StyledBadge = withStyles((theme) => ({\r\n    badge: {\r\n        backgroundColor: '#44b700',\r\n        color: '#44b700',\r\n        boxShadow: `0 0 0 2px ${theme.palette.background.paper}`,\r\n        '&::after': {\r\n            position: 'absolute',\r\n            top: 0,\r\n            left: 0,\r\n            width: '100%',\r\n            height: '100%',\r\n            borderRadius: '50%',\r\n            animation: '$ripple 1.2s infinite ease-in-out',\r\n            border: '1px solid currentColor',\r\n            content: '\"\"',\r\n        },\r\n    },\r\n    '@keyframes ripple': {\r\n        '0%': {\r\n            transform: 'scale(.8)',\r\n            opacity: 1,\r\n        },\r\n        '100%': {\r\n            transform: 'scale(2.4)',\r\n            opacity: 0,\r\n        },\r\n    },\r\n}))(Badge);\r\n\r\nclass OnlineUserItem extends Component {\r\n\r\n    render() {\r\n        let prepareAvatar = this.prepareAvatar(this.props.isOnline);\r\n\r\n        return (\r\n            <ListItem alignItems=\"flex-start\">\r\n                <ListItemAvatar>\r\n                    {prepareAvatar}\r\n                </ListItemAvatar>\r\n                <ListItemText\r\n                    primary={this.props.user.userName}\r\n                    secondary={\r\n                        <React.Fragment>\r\n                            <Typography\r\n                                component=\"span\"\r\n                                variant=\"body2\"\r\n                                color=\"textPrimary\"\r\n                            >\r\n                                <Button variant=\"contained\" color=\"primary\" onClick={\r\n                                    (e) =>\r\n                                    {this.props.onClick(this.props.user.userId)}\r\n                                }>\r\n                                    Send Message\r\n                                </Button>\r\n                            </Typography>\r\n                        </React.Fragment>\r\n                    }\r\n                />\r\n            </ListItem>);\r\n    }\r\n\r\n    prepareAvatar(isOnline) {\r\n        if(isOnline) {\r\n            return (\r\n                <StyledBadge\r\n                    overlap=\"circle\"\r\n                    anchorOrigin={{\r\n                        vertical: 'bottom',\r\n                        horizontal: 'right',\r\n                    }}\r\n                    variant=\"dot\"\r\n                >\r\n                    <Avatar alt={this.props.user.userName} src={this.props.user.avatar} />\r\n                </StyledBadge>\r\n            );\r\n        } else {\r\n            return (\r\n                <Avatar alt={this.props.user.userName} src={this.props.user.avatar} />\r\n            );\r\n        }\r\n    }\r\n}\r\n\r\nexport default OnlineUserItem;\r\n","import {Component} from \"react\";\r\nimport SockJsClient from \"react-stomp\";\r\nimport GlobalConstant from \"../config/GlobalConstant\";\r\nimport React from \"react\";\r\nimport List from \"@material-ui/core/List/List\";\r\nimport Typography from \"@material-ui/core/Typography/Typography\";\r\nimport Divider from \"@material-ui/core/Divider/Divider\";\r\nimport OnlineUserItem from \"../component/user/OnlineUserItem\";\r\nimport UserContextHolder from \"../holder/UserContextHolder\";\r\n\r\nclass OnlineUsers extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        console.log(props);\r\n        this.state = {users: props.users}\r\n    }\r\n\r\n    onMessage(data) {\r\n        UserContextHolder.onlineUsersHolder = data;\r\n        let onlineUser = this.prepareUsers(data);\r\n        this.setState({users: onlineUser});\r\n    }\r\n\r\n    prepareUsers(onlineUser) {\r\n        let usersClone = this.state.users;\r\n        let users = [];\r\n        for(let userIndex in usersClone) {\r\n            users.push(\r\n                {\r\n                    userId: usersClone[userIndex].userId,\r\n                    isOnline: false,\r\n                    userName: usersClone[userIndex].userName,\r\n                    avatar: usersClone[userIndex].avatar\r\n                }\r\n            );\r\n        }\r\n        if(onlineUser !== null && onlineUser !== undefined) {\r\n            for(let userIndex in onlineUser) {\r\n                let user = onlineUser[userIndex];\r\n                let foundUserIndex = this.findUserIndex(user.userId, users);\r\n\r\n                if(foundUserIndex == -1) {\r\n                    user.isOnline = true;\r\n                    users.push({\r\n                        userId: user.userId,\r\n                        isOnline: true,\r\n                        userName: user.userName,\r\n                        avatar: user.avatar\r\n                    }\r\n                        );\r\n                } else {\r\n                    let inStateUser = users[foundUserIndex];\r\n                    inStateUser.isOnline = true;\r\n                }\r\n            }\r\n            return users;\r\n        }\r\n        return users;\r\n    }\r\n\r\n\r\n\r\n    findUserIndex(userId, list) {\r\n        if(list === null || list === undefined)\r\n            return -1;\r\n        for(let user in list) {\r\n            if(list[user].userId === userId) {\r\n                return user;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n\r\n    render() {\r\n        let onlineUserItems = this.getOnlineUserItems();\r\n        return (\r\n            <div>\r\n                <SockJsClient url={GlobalConstant.FULL_WEB_SOCKET_URL} topics={['/topics/user/online']}\r\n                              onMessage={this.onMessage.bind(this)}\r\n                              ref={(client) => {\r\n                                  this.clientRef = client\r\n                              }}\r\n                              />\r\n                <Typography variant=\"h4\" component=\"h4\" style={{\"textAlign\":\"center\"}}>\r\n                   Users\r\n                </Typography>\r\n                <Divider/>\r\n                <List>\r\n                    {onlineUserItems}\r\n                </List>\r\n                <Divider/>\r\n\r\n            </div>\r\n        );\r\n    }\r\n\r\n    onSendButtonClicked(userId) {\r\n        this.props.onSendButtomClicked(userId);\r\n    }\r\n\r\n    getOnlineUserItems() {\r\n        if(this.state.users === null || this.state.users === undefined) {\r\n            if(UserContextHolder.onlineUsersHolder !== null) {\r\n                this.setState({users: UserContextHolder.onlineUsersHolder});\r\n            }\r\n            return (<div/>);\r\n        }\r\n        let users = this.state.users;\r\n\r\n        let result = users.map((value, index) => {\r\n            if(value.userId !== UserContextHolder.userHolder.userId) {\r\n                return (<OnlineUserItem user={value} onClick={this.onSendButtonClicked.bind(this)} isOnline={value.isOnline}/>);\r\n            } else {\r\n                return(<div/>);\r\n            }\r\n        });\r\n        return result;\r\n    }\r\n}\r\n\r\nexport default OnlineUsers;\r\n","import React, {Component} from 'react';\r\nimport './App.css';\r\nimport Grid from \"@material-ui/core/Grid/Grid\";\r\nimport Paper from \"@material-ui/core/Paper/Paper\";\r\nimport ChatRoom from \"./page/chat/ChatRoom\";\r\nimport UserContextHolder from \"./holder/UserContextHolder\";\r\nimport UserAction from \"./action/UserAction\";\r\nimport AppBar from \"@material-ui/core/AppBar/AppBar\";\r\nimport Toolbar from \"@material-ui/core/Toolbar/Toolbar\";\r\nimport IconButton from \"@material-ui/core/IconButton/IconButton\";\r\nimport Typography from \"@material-ui/core/Typography/Typography\";\r\nimport Button from \"@material-ui/core/Button/Button\";\r\nimport OnlineUsers from \"./page/OnlineUsers\";\r\nimport ApiCaller from \"./api/ApiCaller\";\r\n\r\nclass App extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            isReady: false,\r\n            roomId: null,\r\n            roomTitle: undefined,\r\n            messages: undefined\r\n        };\r\n        this.chatRoom = null;\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\r\n        return true;\r\n    }\r\n\r\n    render() {\r\n        if (!this.state.isReady) {\r\n            this.getUserContext();\r\n            return (<div/>)\r\n        } else {\r\n            return (\r\n                <div>\r\n                    <AppBar position=\"static\" color={\"secondary\"}>\r\n                        <Toolbar>\r\n                            <Typography variant=\"h6\">\r\n                                Chatting room\r\n                            </Typography>\r\n                        </Toolbar>\r\n                    </AppBar>\r\n                    <Grid\r\n                        alignItems=\"center\"\r\n                        container\r\n                        direction=\"row\"\r\n                        justify=\"space-between\"\r\n                        style={{\"padding\": \"20px\"}}\r\n                    >\r\n                        <Grid alignItems=\"center\" xs={3} style={{\"height\": \"auto\"}}>\r\n                            <Paper>\r\n                                <OnlineUsers onSendButtomClicked={this.prepareRoomForUser.bind(this)} users={UserContextHolder.userHolder.userDataDtoSet}/>\r\n                            </Paper>\r\n                        </Grid>\r\n\r\n                        <Grid alignItems=\"center\" xs={8}>\r\n                            <ChatRoom roomId={this.state.roomId} title={this.state.roomTitle} ref={(e) => {this.chatRoom = e}} messages={this.state.messages}/>\r\n                        </Grid>\r\n\r\n                    </Grid>\r\n                </div>\r\n            );\r\n        }\r\n    }\r\n\r\n    prepareRoomForUser(userId) {\r\n        ApiCaller.call(ApiCaller.PREPARE_ROOM, \"POST\", {\"userId\": userId},\r\n            (res) => {\r\n                this.setState(\r\n                    {\r\n                        roomId: res.roomId,\r\n                        roomTitle: res.roomTitle,\r\n                        messages: res.historicalMessagesDTO.messages\r\n                    }, () => {\r\n                    this.chatRoom.changeRoom(this.state.roomId, this.state.roomTitle, this.state.messages)\r\n                });\r\n            });\r\n    }\r\n\r\n    getSetUserHolder(res) {\r\n        UserContextHolder.userHolder = res;\r\n        this.setState({isReady: true, roomId: res.lastRoomId, roomTitle: res.roomTitle});\r\n    }\r\n\r\n    getUserContext() {\r\n        UserAction.getUserContext(this.getSetUserHolder.bind(this));\r\n    }\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}